# Memory

CodeBuddy Code 支持将关键信息持久化为“记忆”，在后续对话与任务中自动作为上下文提供，减少重复说明，提升协作效率。

## 记忆范围

- 用户级（user）：存放与个人长期偏好和习惯相关的信息
- 项目级（project）：存放与当前项目共享的通用信息

对应文件位置：
- 用户级：~/.codebuddy/CODEBUDDY.md
- 项目级：./CODEBUDDY.md

记忆内容以章节形式追加到文件中的“## CodeBuddy Added Memories”段落。

## @import 引用

记忆文件支持通过 `@import <path>` 引用其他文件片段，便于复用现有文档中的规则或约定：

- 支持相对路径或绝对路径
- 引用内容在运行时被展开并参与上下文
- 可用于引入团队规范、API 契约、约定式提交规则等

示例：

```
## CodeBuddy Added Memories
@import ./docs/team-conventions.md
- 项目默认分支为 main
```

> 建议：将体量较大的规范拆分为独立 Markdown，并在记忆文件中使用 @import 引用，便于维护。

## 如何添加记忆

当前版本暂不支持使用斜杠命令添加记忆。请直接编辑上述记忆文件，将事实以列表项形式追加到“CodeBuddy Added Memories”章节。

规范：
- fact：要保存的事实，建议简洁、可验证、可复用
- scope：user | project（通过选择编辑对应文件实现）

去重：如果相同的条目已存在，请勿重复添加。

## 会话中的使用

- 启动会话时，会自动加载用户级与项目级记忆，作为隐式上下文
- 模型在生成回答、计划与工具调用时会参考这些记忆

## 文件格式

记忆文件为 Markdown：

```
## CodeBuddy Added Memories
- 团队默认使用 gpt-5 模型
- 测试覆盖率要求 ≥ 80%
```

系统会确保在已有内容与记忆章节之间保持正确的换行与分隔。

## 最佳实践

- 将长期有效的偏好与规范写入 user 或 project 记忆
- 保持“事实化”“可复用”“与任务强相关”的粒度

## 注意

- 记忆写入会在工程根目录或用户目录创建/更新对应文件
- 若文件不存在将自动创建
- 当前版本不提供记忆的交互式管理界面，后续版本将完善
